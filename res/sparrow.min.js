(function(ns){ 'use strict';
ns._=function(a,b){void 0===b&&(b=a,a=document);if(!b)return[a];if(0<b.indexOf(" ")||!/^[#.]?\w+$/.test(b))return a.querySelectorAll(b);if("#"===b.charAt(0)){var c=a.getElementById(b.substr(1));return c?[c]:[]}return"."===b.charAt(0)?a.getElementsByClassName(b.substr(1)):a.getElementsByTagName(b)};_.ary=function(a,b,c){return"string"===typeof a||void 0===a.length?[a]:0>=a.length?[]:void 0===b?a instanceof Array?a:Array.prototype.slice.call(a,0):Array.prototype.slice.call(a,b,c)};
_.toAry=function(a){return a instanceof Array?a:[a]};_.col=function(a,b){a=_.ary(a);return void 0===b?a.map(function(a){return a[0]}):2===arguments.length?a.map(function(a){return a[b]}):a.map(function(a){for(var b=[],e=1,f=arguments.length;e<f;e++)b.push(a[arguments[e]]);return b})};_.sorter=function(a,b){var c=b?-1:1;return function(b,f){if(a!==undefined){b=b[a];f=f[a];}return b>f?c:b<f?-c:0}};
_.sorter.number=function(a,b){var c=b?0:1,d=-c;return void 0===a?function(a,b){return+a>+b?c:+a<+b?d:0}:function(b,f){return+b[a]>+f[a]?c:+b[a]<+f[a]?d:0}};_.sort=function(a,b,c){return _.ary(a).sort(_.sorter(b,c))};_.mapper=function(a){var b=arguments,c=b.length;return 0>=c?_.dummy():1===c&&"string"===typeof a?function(b){return b[a]}:function(a){for(var e=[],f=_.mapper._map,g=0;g<c;g++)e.push(f(a,b[g]));return 1===c?e[0]:e}};
_.mapper._map=function _mapper_map(b,c){if(_.is.literal(c))return b[c];if(c instanceof Array){for(var d=0,e=c.length;d<e&&void 0!==b&&null!==b;d++)b=b[c[d]];return b}d=new _.Map;for(e in c)d[e]=_mapper_map(b,c[e]);return d};_.map=function(a,b){return _.ary(a).map(_.mapper.apply(null,_.ary(arguments).slice(1)))};_.dummy=function(){};_.echo=function(a){return a};_.call=function(a,b,c){return void 0===a||null===a?void 0:a.apply(b,_.ary(arguments,2))};
_.is={ie:function(){var a=/\bMSIE \d|\bTrident\/\d\b./.test(navigator.userAgent);_.is.ie=function(){return a};return a},firefox:function(){var a=/\bGecko\/\d{8}/.test(navigator.userAgent);_.is.firefox=function(){return a};return a},activeX:function(){var a=!1;try{a=!!new ActiveXObject("htmlfile")}catch(b){}_.is.activeX=function(){return a};return a},literal:function(a){if(void 0===a||null===a)return a;a=typeof a;return"boolean"===a||"number"===a||"string"===a},object:function(a){if(void 0===a||null===
a)return a;a=typeof a;return"object"===a||"function"===a},yes:function(a){var b=typeof a;if("string"===b){a=a.trim().toLowerCase();if(0<=["true","on","yes","1"].indexOf(a))return!0;if(0<=["false","off","no","0"].indexOf(a))return!1}else if("boolean"===b||"number"===b)return a?!0:!1;return null}};
_.clear=function _clear(e){_.ary(_.domlist(e)).forEach(function _clear_each(p){var c=p.firstChild;if(!c)return;do{p.removeChild(c)}while(c=p.firstChild)});return e};_.html=function(a){var b=_.html.node=document.createElement("div");b.innerHTML=a;return b};
_.assert=function(a,b){if(!1===a||void 0===a||null===a)throw void 0===b&&(b=""),"string"===typeof b&&(b="Assertion failed ("+b+")"),Error(b);};_.log=function(a,b){void 0===b&&(b=a,a="log");console&&(console[a]||(a="log"),console[a](b))};_.info=function(a){_.log("info",a)};_.warn=function(a){_.log("warn",a)};_.error=function(a){_.log("error",a)};
_.alert=function(a){_.alert.timeout||(_.alert.timeout=setTimeout(function(){_.alert.timeout=0;alert(_.alert.log);_.alert.log=[]},50));0>_.alert.log.indexOf(a)&&_.alert.log.push(a)};_.alert.timeout=0;_.alert.log=[];_.time=function(a){var b=_.time,c=new Date;if(void 0===a)b.base=c,b.last=null;else{var d=c-b.base,e=c-b.last;_.info(a+" (+"+d+(b.last?"ms,+"+e:"")+"ms)");b.last=c;return[e,d]}};
_.escHtml=function(a){return/[<&'"]/.test(a)?a.replace(/[&<"']/g,function(a){return{"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"}[a]}):a};_.escJs=function(a){return a.replace(/\r?\n/g,"\\n").replace(/'"/g,"\\$0")};_.escRegx=function(a){return a.replace(/([()?*+.\\{}[\]])/g,"\\$1")};_.round=function(a,b){var c=Math.pow(10,~~b);return Math.round(a*c)/c};
_.si=function(a,b){if("string"===typeof a){if(!/^-?\d+(\.\d+)?[kmgtp]$/i.test(a))return+a;var c=a.length-1,d=a.charAt(c).toLowerCase();return a.substr(0,c)*{k:1E3,m:1E6,g:1E9,t:1E12,p:1E15}[d]}for(c=0;1E3<a||-1E3>a;)a/=1E3,++c;return _.round(a,b)+" k M G T P".split(" ")[c]};_.halfwidth=function(a){for(var b=0,c=0,d=a.length;c<d;c++){var e=a.charCodeAt(c);25>e||(b=511>e?b+1:65376>e?b+2:65439>e?b+1:b+2)}return b};
_.proto=function(a){if(null===a||void 0===a)return a;if("object"===typeof a||"function"===typeof a)return Object.getPrototypeOf(a)};_.inherit=function _inherit(b,c,d){_.assert(!b||b.prototype,_inherit.name+": base must be inheritable");_.assert(null===c||"function"===typeof c,_inherit.name+": constructor must be function");null===c&&(c=b?function(){b.apply(this,arguments)}:function(){});if(b){var e=c.prototype=Object.create(b.prototype);if(d)for(var f in d)e[f]=d[f]}else c.prototype=d;return c};
_.deepclone=function(a){return _.clone(a,!0)};_.clone=function(a,b){var c;if(null===a)return a;switch(typeof a){case "object":c=a instanceof Array?[]:Object.create(Object.getPrototypeOf(a));break;case "function":c=function(){return a.apply(this,arguments)};c.prototype=a.prototype;break;default:return a}for(var d in a)c[d]=b?_.clone(a[d],b):a[d];return c};_.extend=function(a,b){Object.keys(b).forEach(function(c){a[c]=b[c]});return a};_.freeze=Object.freeze?function(a){return Object.freeze(a)}:_.echo;
_.seal=Object.seal?function(a){return Object.seal(a)}:_.echo;_.noExt=Object.preventExtensions?function(a){return Object.preventExtensions(a)}:_.echo;_.noDef=function(a){a&&a.preventDefault&&a.preventDefault();return!1};_.create=function(a,b){var c=document.createElement(a);b&&("object"!==typeof b?c.textContent=b:_.attr(c,b));return c};_.domlist=function(a){return"string"===typeof a?_(a):void 0===a.length?[a]:a};
_.set=function(a,b,c,d){if("string"===typeof a||a&&a[0]instanceof Element){if(d&&"^"!==d)throw Error("Property flags cannot be set on DOM elements");return _.attr(a,b,c)}var e=b,f;_.is.literal(b)&&(e={},e[b]=c);a=_.ary(a);if(d&&"^"!==d&&Object.defineProperties){d=d.toLowerCase();var g={};b=0>d.indexOf("c");c=0>d.indexOf("e");d=0>d.indexOf("w");for(f in e)g[f]={value:e[f],configurable:b,enumerable:c,writable:d};f=function(a){Object.defineProperties(a,g)}}else f=function(a){for(var b in e)a[b]=e[b]};
a.forEach(f);return a};_.proto=function(a){if(void 0===a||null===a)return a;if(_.is.object(a))return Object.getPrototypeOf(a)};
_.attr=function(a,b,c){var d=b;_.is.literal(b)&&(d={},d[b]=c);a=_.ary(_.domlist(a));a.forEach(function(a){for(var b in d)switch(b){case "text":a.textContent=d.text;break;case "html":a.innerHTML=d.html;break;case "class":case "className":a.className=d[b];break;case "style":if("object"===typeof d[b]){_.style(a,d[b]);break}default:"on"===b.substr(0,2)?a.addEventListener(b.substr(2),d[b]):void 0!==d[b]?a.setAttribute(b,d[b]):a.removeAttribute(b)}});return a};
_.style=function(a,b,c){var d=b;"string"===typeof d&&(d={},d[b]=c);"string"===typeof a&&(a=_(a));a=_.ary(a);a.forEach(function(a){for(var b in d)void 0!==d[b]?a.style[b]=d[b]:(a.style[b]="",delete a.style[b])});return a};_.show=function(a){return _.style(a,"display",void 0)};_.hide=function(a){return _.style(a,"display","none")};_.visible=function(a,b){return b?_.show(a):_.hide(a)};_.hasClass=function(a,b){return _.domlist(a).some(function(a){return 0<=a.className.split(/\s+/).indexOf(b)})};
_.removeClass=function(a,b){void 0===b&&(b=a.match(/\.[^. :#>+~()\[\]]+$/)[0].substr(1));return _.toggleClass(a,b,!1)};_.toggleClass=function(a,b,c){a=_.domlist(a);for(var d="string"===typeof b?[b]:b,e=a.length-1;0<=e;e--){for(var f=b=a[e].className,f=f.split(/\s+/),g=d.length-1;0<=g;g--){var h=d[g],k=f.indexOf(h);0>k&&(c||void 0===c)?f.push(h):0<=k&&(!c||void 0===c)&&f.splice(k,1)}f=f.join(" ");b!==f&&(a[e].className=f)}return a};_.Map=function(){return Object.create(null)};
_.info("Sparrow loaded.");_.time();})(this);